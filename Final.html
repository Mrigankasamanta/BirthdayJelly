<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Card for Jelly</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <audio id="bgMusic" loop>
        <source src="song4.mp3" type="audio/mpeg">
    </audio>

    <img src="ZUiY.gif" alt="stars" class="star">
    <img src="5l03.gif" alt="ballon" class="ballon">
    <div class="container">
        <div class="birthdayCard">
            <div class="cardFront">
                <div class="front-text">
                    <h3 class="happy">HAPPY</h3>
                    <h2 class="bday">BIRTHDAY</h2>
                    <h3 class="toyou">to you Jelly!</h3>
                </div>
                <div class="wrap-deco">
                    <div class="decorations"></div>
                    <div class="decorationsTwo"></div>
                </div>
                <div class="wrap-decoTwo">
                    <div class="decorations"></div>
                    <div class="decorationsThree"></div>
                </div>
                <div class="plate">
                    <div class="cake"></div>
                    <div class="flame"></div>
                </div>
            </div>
            <div class="cardInside">
                <div class="img">
                    <img src="penguin.jpg" alt="Brotherpic" class="bdyboy">
                    <img src="6ob.gif" alt="confetti" class="confetti">
                </div>
                <div class="inside-text">
                    <h3 class="happy">HAPPY</h3>
                    <h2 class="bday">BIRTHDAY</h2>
                    <h3 class="toyou">to you Janu</h3>
                </div>
                <div class="wishes">
                    <p>Dear Jelly,</p>
                    <p>Happy birthday!! I hope your day is filled with lots of love and laughter! May all of your
                        birthday wishes come true.</p>
                    <p class="name">~ Your Motu‚ù§Ô∏è</p>
                </div>
            </div>
        </div>
    </div>

    <img src="4SHX.gif" alt="cat" class="cat">

    <section class="folder" aria-label="Photo folder">
        <div id="trainArea" class="train-wrapper" role="region" aria-label="Photo train">
            <div id="trainStack" aria-hidden="false"></div>

            <button id="trainPrev" class="train-nav train-prev" aria-label="Previous">&#10094;</button>
            <button id="trainNext" class="train-nav train-next" aria-label="Next">&#10095;</button>
        </div>

        <div id="trainBelowCaption" class="stack-caption" aria-hidden="true" style="display:none;">&nbsp;</div>
    </section>

    <div class="wish-container">
        <h2 class="wish-title">Leave a Wish for Jelly! üíå</h2>

        <div class="input-group">
            <input type="text" id="wisherName" placeholder="‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ (Your Name)">
            <textarea id="wisherMessage" placeholder="‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶â‡¶á‡¶∂ ‡¶≤‡ßá‡¶ñ‡ßã... (Write your wish)"></textarea>
            <button onclick="sendWish()">Send Wish üöÄ</button>
        </div>

        <div id="messagesArea" class="messages-list">
        </div>
    </div>

    <div id="imageLightbox" class="lightbox-modal">
        <span class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightboxImg">
    </div>

    <script type="module">
        // ==========================================
        // 1. FIREBASE CONFIGURATION
        // ==========================================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onChildAdded, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD9IMQ-_ZLHwPhWORBvrREGcwJ5ddg7y7M",
            authDomain: "jellybirthday-e04c8.firebaseapp.com",
            databaseURL: "https://jellybirthday-e04c8-default-rtdb.firebaseio.com",
            projectId: "jellybirthday-e04c8",
            storageBucket: "jellybirthday-e04c8.firebasestorage.app",
            messagingSenderId: "567315973038",
            appId: "1:567315973038:web:e0e64df2ccd05db0547e3f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const messagesRef = ref(db, 'wishes');

        // --- Send Message Function ---
        window.sendWish = function () {
            const name = document.getElementById('wisherName').value;
            const msg = document.getElementById('wisherMessage').value;

            if (name.trim() === "" || msg.trim() === "") {
                alert("Please enter both name and message!");
                return;
            }

            push(messagesRef, {
                name: name,
                message: msg,
                reply: ""
            }).then(() => {
                document.getElementById('wisherMessage').value = "";
                alert("Wish Sent Successfully! ‚ù§Ô∏è");
            }).catch((error) => {
                alert("Error sending wish: " + error.message);
            });
        }

        // --- Load Messages Function ---
        onChildAdded(messagesRef, (snapshot) => {
            const data = snapshot.val();
            const key = snapshot.key;
            addMessageToUI(key, data.name, data.message, data.reply);
        });

        function addMessageToUI(key, name, msg, reply) {
            const list = document.getElementById('messagesArea');
            const div = document.createElement('div');
            div.className = 'message-card';
            div.id = `msg-${key}`;

            let replyHtml = reply ? `<div class="reply-text"><strong>Reply:</strong> ${reply}</div>` : '';

            div.innerHTML = `
                <div class="msg-name">${name} wrote:</div>
                <div class="msg-text">${msg}</div>
                <div id="reply-box-${key}">${replyHtml}</div>
                <button class="admin-reply-btn" onclick="adminReply('${key}')">Reply</button>
            `;
            list.insertBefore(div, list.firstChild);
        }

        // --- Admin Reply Function ---
        window.adminReply = function (key) {
            const pass = prompt("Enter Admin Password to Reply:");
            if (pass === "122004") {
                const replyText = prompt("Type your reply:");
                if (replyText) {
                    const updates = {};
                    updates['/wishes/' + key + '/reply'] = replyText;
                    update(ref(db), updates);
                    document.getElementById(`reply-box-${key}`).innerHTML = `<div class="reply-text"><strong>Reply:</strong> ${replyText}</div>`;
                }
            } else {
                alert("Wrong Password! You cannot reply.");
            }
        }

        // ==========================================
        // 2. MUSIC ON FIRST CLICK LOGIC
        // ==========================================
        // ‡¶™‡ßá‡¶ú‡ßá ‡¶Ø‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶ú‡¶æ‡¶Ø‡¶º‡¶ó‡¶æ‡¶Ø‡¶º ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ó‡¶æ‡¶® ‡¶¨‡¶æ‡¶ú‡¶¨‡ßá
        document.addEventListener('click', function() {
            const bgMusic = document.getElementById('bgMusic');
            // ‡¶ó‡¶æ‡¶® ‡¶Ø‡¶¶‡¶ø ‡¶™‡¶ú (paused) ‡¶•‡¶æ‡¶ï‡ßá ‡¶§‡¶¨‡ßá‡¶á ‡¶™‡ßç‡¶≤‡ßá ‡¶π‡¶¨‡ßá
            if(bgMusic.paused) {
                bgMusic.play().then(() => {
                    console.log("Music started!");
                }).catch(e => {
                    console.log("Audio play failed:", e);
                });
            }
        }, { once: true }); // { once: true } ‡¶Æ‡¶æ‡¶®‡ßá ‡¶è‡¶á ‡¶ï‡ßã‡¶°‡¶ü‡¶æ ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞‡¶á ‡¶∞‡¶æ‡¶® ‡¶π‡¶¨‡ßá

        // ==========================================
        // 3. GALLERY & CAPTION LOGIC
        // ==========================================
        const imageCount = 33;
        const imgFolder = 'images';

        const customCaptions = [
            "‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßá‡¶á ‡¶ó‡¶æ‡¶°‡¶º‡¶ø‡¶§‡ßá ‡¶ï‡¶∞‡ßá ‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶Ø‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ üòÑ",
            "‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßá‡¶á ‡¶™‡¶°‡¶º‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡¶æ‡¶°‡¶º‡¶ø ‡¶´‡ßá‡¶∞‡¶æ‡¶∞‡¶™‡¶•‡ßá ‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤‡¶æ‡¶Æ ‡¶§‡¶æ‡¶á ‡¶∏‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶´‡¶ü‡ßã ‡¶§‡ßÅ‡¶≤‡¶≤‡¶æ‡¶Æ üòÜ",
            "‡¶¶‡ßÅ‡¶ú‡¶®‡ßá‡¶∞ ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ï‡¶¶‡ßç‡¶¨‡ßÄ‡¶™‡ßá ‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶Ø‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ üòä",
            "‡¶è‡¶á ‡¶∏‡ßá‡¶á ‡¶¶‡¶ø‡¶® ‡¶Ø‡ßá‡¶¶‡¶ø‡¶® ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ö‡¶∂‡¶Æ‡¶æ ‡¶π‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤ üòÖ",
            "‡¶Ö‡¶∂‡ßã‡¶ï ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶è‡¶∞ ‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶§‡ßá ‡¶¶‡ßÅ‡¶ú‡¶®‡ßá‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶ï‡¶∞‡¶æ üòú",
            "‡¶ü‡¶ø‡¶â‡¶∂‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶´‡ßá‡¶∞‡¶æ‡¶∞ ‡¶™‡¶•‡ßá ‡¶´‡¶ü‡ßã ‡¶§‡ßÅ‡¶≤‡¶æ üòÅ",
            "‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶ü‡¶æ‡¶®‡¶æ ‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶´‡¶ü‡ßã ‡¶§‡ßÅ‡¶≤‡¶æ üòÇ",
            "‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶Ü‡¶∏‡ßá‡¶®‡¶ø ‡¶¨‡¶≤‡ßá ‡¶´‡¶ü‡ßã ‡¶§‡ßÅ‡¶≤‡¶õ‡¶ø‡¶≤‡¶æ‡¶Æ üòÜ",
            "‡¶Ö‡¶®‡ßá‡¶ï ‡¶Æ‡¶æ‡¶∞‡¶æ‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ù‡¶ó‡¶°‡¶º‡¶æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶∂‡ßá‡¶∑‡ßá ‡¶∏‡¶∞‡¶∏‡ßç‡¶¨‡¶§‡ßÄ ‡¶™‡ßÅ‡¶ú‡ßã‡¶§‡ßá ‡¶ò‡ßÅ‡¶∞‡¶§‡ßá ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ 8no ‡¶è ü§ó",
            "‡¶â‡¶ö‡ßç‡¶ö‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡¶ø‡¶ï ‡¶∂‡ßá‡¶∑ ‡¶§‡ßã ‡¶∏‡ßá‡¶á‡¶¶‡¶ø‡¶®‡¶á ‡¶ö‡¶≤‡ßá ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ 8no ‡¶è ‡¶ò‡ßÅ‡¶∞‡¶§‡ßá üòÉ",
            "‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶∏‡ßá‡¶á ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® ‡¶™‡¶æ‡¶≤‡¶® ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶Ü‡¶Æ‡¶æ‡¶∞ Jelly ‡¶™‡¶æ‡¶≤‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤ ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶è‡¶∞ ‡¶ì‡¶ñ‡¶æ‡¶®‡ßá ‚ò∫Ô∏è",
            "‡¶¶‡ßÅ‡¶ú‡¶®‡ßá‡¶∞ ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶á‡¶ï‡ßá‡¶≤ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶∏‡ßá‡¶á ‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶Ø‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶â‡¶´‡ßç ‡¶ï‡¶ø ‡¶¶‡¶ø‡¶® ü•π",
            "‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶∞‡ßá‡¶∏‡ßç‡¶ü‡ßÅ‡¶∞‡ßá‡¶®‡ßç‡¶ü‡ßá ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ ‡¶¶‡ßÅ‡¶ú‡¶®‡ßá ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ü•∞",
            "‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ó‡¶≤‡ßÄ‡¶ü‡¶æ‡¶∞ ‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º‡¶¨‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡ßã‡¶® ‡¶è‡¶≤‡ßã ‡¶Ü‡¶Æ‡¶ø unboxing ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤‡¶æ‡¶Æ üòÅ",
            "‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ó‡¶∞‡ßÅ‡¶ü‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶≤‡¶ï‡¶æ‡¶§‡¶æ‡¶Ø‡¶º ‡¶è‡¶∏‡ßá ‡¶•‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Æ‡ßá‡¶∏ ‡¶¨‡¶æ ‡¶ò‡¶∞ ‡¶ñ‡ßã‡¶ú‡¶æ ü•≥",
            "‡ß®‡ß¶‡ß®‡ß© ‡¶è ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶ò‡ßÅ‡¶∞‡¶§‡ßá ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ ‡¶ï‡¶≤‡¶ï‡¶æ‡¶§‡¶æ‡¶Ø‡¶º ‡¶∏‡¶∞‡¶∏‡ßç‡¶¨‡¶§‡ßÄ ‡¶™‡ßÇ‡¶ú‡¶æ‡¶Ø‡¶º ü§ó",
            "‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶∏‡¶∞‡ßã‡¶¨‡¶∞ ‡¶è ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ ‡¶ò‡ßÅ‡¶∞‡¶§‡ßá üòå",
            "‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶™‡¶æ‡¶ü‡ßÅ‡¶≤‡¶ø‡¶§‡ßá ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶ï‡¶§‡¶ó‡ßÅ‡¶≤‡ßã ‡¶´‡¶ü‡ßã ‡¶§‡ßÅ‡¶≤‡¶æ‡¶≤ üòÆ‚Äçüí® ‡¶è‡¶ü‡¶æ ‡¶õ‡¶ø‡¶≤ ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ü‡ßÅ‡¶≤‡ßÄ‡¶§‡ßá ‡¶Ø‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ üòÑ",
            "‡¶¶‡ßÅ‡¶ú‡¶®‡ßá ‡¶Æ‡¶ø‡¶≤‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£‡ßá‡¶∂‡ßç‡¶¨‡¶∞ ‡¶è ‡¶Æ‡¶æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶™‡ßÇ‡¶ú‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ üôè",
            "‡¶¶‡ßÅ‡¶ú‡¶®‡ßá‡¶∞ ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡ß®‡ß¶‡ß®‡ß© ‡¶è ‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶™‡ßÅ‡¶ú‡ßã‡¶§‡ßá ‡¶ò‡ßÅ‡¶∞‡¶æ ‡¶ï‡ßÅ‡¶≤‡¶™‡¶ø‡¶§‡ßá ü§´",
            "‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ó‡¶≤‡ßÄ‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡¶≤‡¶æ‡¶∞‡¶∂‡¶ø‡¶™ reject ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶¶‡ßÅ‡¶ú‡¶®‡ßá ‡¶∏‡ßá‡¶á ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ Swasthya Bhawan ‡¶è üòâ",
            "‡¶™‡¶æ‡¶ó‡¶≤‡ßÄ ‡¶ï‡ßá ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ò‡ßÅ‡¶∞‡¶§‡ßá ‡¶ó‡ßá‡¶õ‡¶ø‡¶≤‡¶æ‡¶Æ ‡¶¨‡¶ï‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶§‡ßá ‡¶∏‡ßá‡¶á‡¶¶‡¶ø‡¶® ‡¶ï‡¶§ ‡¶´‡¶ü‡ßã ‡¶§‡ßÅ‡¶≤‡¶≤‡¶æ‡¶Æ ü§´",
            "‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶™‡ßà‡¶≤‡¶æ‡¶® ‡¶Æ‡¶®‡ßç‡¶¶‡¶ø‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶≤‡¶æ‡¶Æ ‡¶Ü‡¶∞ ‡¶ò‡ßÅ‡¶∞‡¶≤‡¶æ‡¶Æ ‡¶´‡¶ü‡ßã ‡¶§‡ßÅ‡¶≤‡¶≤‡¶æ‡¶Æ üôè",
            "‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶∏‡¶∞‡ßã‡¶¨‡¶∞‡ßá ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶è‡¶á‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶¨‡¶æ‡¶á ‡¶Æ‡¶ø‡¶≤‡ßá ‡¶∏‡ßÅ‡¶ï‡ßÅ, ‡¶™‡ßç‡¶∞‡ßÄ‡¶§‡¶Æ, ‡¶Ü‡¶Æ‡¶ø , ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ó‡¶∞‡ßÅ , ‡¶∞‡¶æ‡¶π‡ßÅ‡¶≤ ‡¶Ü‡¶∞ ‡¶ú‡¶Ø‡¶º‡¶∂‡ßç‡¶∞‡ßÄ üòÑ",
            "‡ß®‡ß¶‡ß®‡ß™ ‡¶è ‡¶Ü‡¶Æ‡¶æ‡¶∞ Jelly-‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶ô‡ßç‡¶ó‡ßá ‡¶∏‡ßÅ‡¶ï‡ßÅ ‡¶Ü‡¶∞ ‡¶™‡ßç‡¶∞‡ßÄ‡¶§‡¶Æ‡¶ì ‡¶õ‡¶ø‡¶≤ ‡¶ï‡¶≤‡¶ï‡¶æ‡¶§‡¶æ‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ ü§´",
            "‡ß®‡ß¶‡ß®‡ß™ ‡¶è‡¶á ‡¶¶‡ßÅ‡¶ú‡¶® ‡¶Æ‡¶ø‡¶≤‡ßá ‡¶≤‡¶æ‡¶≤ ‡¶§‡ßÅ‡¶á ‡¶≤‡¶æ‡¶≤ ‡¶∂‡¶æ‡¶°‡¶º‡¶ø ‡¶Ü‡¶∞ ‡¶Ü‡¶Æ‡¶ø ‡¶§‡ßã‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶∏‡ßá‡¶á ‡¶≤‡¶æ‡¶≤ ‡¶™‡¶æ‡¶û‡ßç‡¶ú‡¶æ‡¶¨‡¶ø ‡¶™‡¶°‡¶º‡ßá ‡¶ò‡ßÅ‡¶∞‡¶≤‡¶æ‡¶Æ ü•∞",
            "‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ó‡¶∞‡ßÅ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® ‡¶™‡¶æ‡¶≤‡¶® ‡¶ï‡¶∞‡¶≤‡ßã üòò",
            "‡¶¶‡¶ø‡¶ò‡¶æ‡¶§‡ßá ‡¶ò‡ßÅ‡¶∞‡¶§‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶ñ‡ßÅ‡¶¨ ‡¶Æ‡¶ú‡¶æ ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ó‡¶≤‡¶ø‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶ó‡¶æ‡¶°‡¶º‡¶ø‡¶§‡ßá ‡¶¨‡¶∏‡ßá ‡¶Ø‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ üòç",
            "‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶ú‡ßã‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶è‡¶á ‡¶≠‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ó‡¶ü‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ï‡¶≤‡¶ï‡¶æ‡¶§‡¶æ‡¶Ø‡¶º ‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶™‡ßÇ‡¶ú‡¶æ‡¶Ø‡¶º ‡¶ò‡ßÅ‡¶∞‡¶æ‡¶≤‡ßã ‡ß®‡ß¶‡ß®‡ß´ ‡¶è üòÆ‚Äçüí®",
            "‡¶¶‡ßÅ‡¶ú‡¶®‡ßá 3‡¶¶‡¶ø‡¶® ‡¶ò‡ßÅ‡¶∞‡¶≤‡¶æ‡¶Æ ‡¶ï‡¶≤‡¶ï‡¶æ‡¶§‡¶æ‡¶Ø‡¶º ‡¶è‡¶ü‡¶æ ‡¶§‡ßÉ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶´‡¶ü‡ßã ‡¶Æ‡¶ú‡¶æ ‡¶è‡¶∏‡ßá‡¶õ‡¶ø‡¶≤ ‡¶ò‡ßÅ‡¶∞‡ßá ü•∞",
            "‡ß®‡ß¶‡ß®‡ß´ ‡¶è ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∏‡¶¨‡¶æ‡¶á ‡¶Æ‡¶ø‡¶≤‡ßá ‡¶ï‡ßÅ‡¶≤‡ßç‡¶™‡¶ø‡¶§‡ßá ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ ü§´",
            "‡ß®‡ß¶‡ß®‡ß´ ‡¶è‡¶∞ ‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶™‡ßÇ‡¶ú‡¶æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶∑ ‡¶¶‡¶ø‡¶® ‡¶Æ‡¶æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶¶‡¶∞‡ßç‡¶∂‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶ó‡ßá‡¶≤‡¶æ‡¶Æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶°‡¶æ‡¶Æ ‡¶∞‡ßá‡¶ó‡ßá ‡¶ï‡¶æ‡¶Æ‡¶® ‡¶Æ‡ßÅ‡¶ñ ‡¶¨‡¶æ‡¶ï‡¶æ‡¶≤‡ßã üòí",
            "‡¶è‡¶ï‡¶ü‡ßÅ ‡¶¶‡ßÅ‡¶ú‡¶®‡ßá‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá ‡¶§‡¶æ‡¶ï‡¶ø‡¶Ø‡¶º‡ßá ‡¶≠‡¶æ‡¶≤‡ßã ‡¶è‡¶ï‡¶ü‡¶æ ‡¶´‡¶ü‡ßã ‡¶§‡ßã‡¶≤‡¶æ‡¶∞ ‡¶â‡¶¶‡ßç‡¶Ø‡ßá‡¶∂‡ßá ü§≠"
        ];

        const captions = Array.from({ length: imageCount }, (_, i) => customCaptions[i] || `‡¶∏‡ßç‡¶Æ‡ßÉ‡¶§‡¶ø ${i + 1}`);

        const trainStack = document.getElementById('trainStack');
        const trainArea = document.getElementById('trainArea');
        const lightbox = document.getElementById('imageLightbox');
        const lightboxImg = document.getElementById('lightboxImg');
        const lightboxClose = document.querySelector('.lightbox-close');

        const cards = [];
        for (let i = 1; i <= imageCount; i++) {
            const num = String(i).padStart(2, '0');
            const src = `${imgFolder}/photo${num}.jpg`;
            const card = document.createElement('div');
            card.className = 'stack-card';
            card.dataset.index = i - 1;
            const img = document.createElement('img');
            img.src = src;
            img.alt = captions[i - 1] || `photo ${i}`;
            const cap = document.createElement('div');
            cap.className = 'stack-caption';
            cap.textContent = captions[i - 1] || '';
            card.appendChild(img);
            card.appendChild(cap);
            trainStack.appendChild(card);
            cards.push(card);

            card.addEventListener('click', () => {
                if (card.classList.contains('top')) {
                    stopCycle();
                    lightboxImg.src = img.src;
                    lightbox.style.display = 'flex';
                }
            });
        }

        let current = 0;
        function applyStackClasses(activeIndex) {
            for (let i = 0; i < cards.length; i++) {
                const card = cards[i];
                card.classList.remove('top', 'below', 'deep', 'flip-up', 'flip-initial', 'flip-in', 'flip-down', 'flip-in-rev');
                const rel = (i - activeIndex + cards.length) % cards.length;
                if (rel === 0) { card.classList.add('top'); card.style.zIndex = 30; }
                else if (rel === 1) { card.classList.add('below'); card.style.zIndex = 20; }
                else { card.classList.add('deep'); card.style.zIndex = 10; }
            }
            const belowCaption = document.getElementById('trainBelowCaption');
            if (belowCaption) { belowCaption.style.display = 'block'; belowCaption.textContent = captions[activeIndex] || ''; }
        }
        applyStackClasses(current);

        lightboxClose.addEventListener('click', () => {
            lightbox.style.display = 'none';
            startCycle();
        });
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
                lightbox.style.display = 'none';
                startCycle();
            }
        });

        function performTransition(fromIdx, toIdx, dir = 'next') {
            if (fromIdx === toIdx) return;
            const outgoing = cards[fromIdx];
            const incoming = cards[toIdx];
            if (dir === 'next') {
                incoming.classList.add('flip-initial'); incoming.style.zIndex = 25;
                requestAnimationFrame(() => {
                    outgoing.classList.add('flip-up'); incoming.classList.remove('flip-initial'); incoming.classList.add('flip-in');
                    setTimeout(() => { cards.forEach(c => c.classList.remove('flip-up', 'flip-initial', 'flip-in', 'flip-down', 'flip-in-rev')); current = toIdx; applyStackClasses(current); }, 780);
                });
            } else {
                incoming.classList.add('flip-initial'); incoming.style.zIndex = 25;
                requestAnimationFrame(() => {
                    outgoing.classList.add('flip-down'); incoming.classList.remove('flip-initial'); incoming.classList.add('flip-in-rev');
                    setTimeout(() => { cards.forEach(c => c.classList.remove('flip-up', 'flip-initial', 'flip-in', 'flip-down', 'flip-in-rev')); current = toIdx; applyStackClasses(current); }, 780);
                });
            }
        }

        function doFlip() { performTransition(current, (current + 1) % cards.length, 'next'); }
        function doPrevFlip() { performTransition(current, (current - 1 + cards.length) % cards.length, 'prev'); }

        let intervalMs = 3000;
        let cycleTimer = null;
        function startCycle() { if (cycleTimer) return; cycleTimer = setInterval(doFlip, intervalMs); }
        function stopCycle() { if (!cycleTimer) return; clearInterval(cycleTimer); cycleTimer = null; }
        setTimeout(() => startCycle(), 1500);

        trainArea.addEventListener('mouseenter', stopCycle);
        trainArea.addEventListener('mouseleave', startCycle);

        document.getElementById('trainPrev').addEventListener('click', (e) => { e.stopPropagation(); stopCycle(); doPrevFlip(); setTimeout(() => startCycle(), intervalMs + 200); });
        document.getElementById('trainNext').addEventListener('click', (e) => { e.stopPropagation(); stopCycle(); doFlip(); setTimeout(() => startCycle(), intervalMs + 200); });

        document.addEventListener('keydown', (e) => { if (e.key === 'ArrowRight') { stopCycle(); doFlip(); setTimeout(() => startCycle(), intervalMs + 200); } else if (e.key === 'ArrowLeft') { stopCycle(); doPrevFlip(); setTimeout(() => startCycle(), intervalMs + 200); } });

    </script>
</body>


</html>
